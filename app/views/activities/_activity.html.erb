<%= turbo_stream_from activity %>
<%= render "shared/card/base", id: dom_id(activity), card_class: "bg-base-100 shadow-md mb-3" do %>
  <div class="card-title justify-between">
    <%= link_to activity_path(activity), class: "link link-info" do %>
      <%= render partial: "shared/card/title",
                 locals: { title: activity.label } %>
    <% end %>
    <div class="card-actions">
      <% if activity.user == Current.user %>
        <%= link_to activity_path(activity), class: "btn btn-error btn-sm", data: { turbo_method: :delete, turbo_confirm: "Are you sure you want to delete this activity?" }, title: "Delete activity" do %>
          <%= icon "trash", class: "size-3" %>
        <% end %>
      <% end %>
    </div>
  </div>

  <% if activity.user != Current.user %>
    <div class="text-right text-sm opacity-70 -mt-2 mb-4">
      <%= activity.user.email_address %>
    </div>
  <% end %>

  <%= render "shared/card/property_grid", columns: 2 do %>
    <%= render partial: "shared/card/item",
               locals: { property: "Activity Type", value: activity.class.display_name } %>

    <%= render partial: "shared/card/item",
               locals: { property: data_config_type_label(activity), value: activity.data_config.display_name } %>

    <%= render partial: "shared/card/item",
               locals: {
                 property: "Workflow Task",
                 value: capture do %>
                   <% if activity.current_task %>
                     <span class="font-mono font-medium mr-2"><%= task_name(activity) %></span>
                     <%= format_task_status_badge(activity.current_task.status) %>
                   <% else %>
                     <span class="font-mono font-medium">No task is active</span>
                   <% end %>
                 <% end
               } %>

    <%= render partial: "shared/card/item",
               locals: { property: "Last Updated", value: local_time(activity.updated_at) } %>
  <% end %>
<% end %>
